@echo off
:CheckConnection
netstat -n | find "VPN_IP" >nul
if %errorlevel%==1 (
    # Connection lost
    powershell.exe -ExecutionPolicy Bypass -File CloseBurp.ps1
    goto :EOF
) else (
    # Connection active
    timeout /t 60 >nul
    goto CheckConnection
)



# Get the Burp Suite process
$process = Get-Process -Name "burp" -ErrorAction SilentlyContinue

if ($process) {
    # Close Burp Suite gracefully
    $process.CloseMainWindow()
    # Wait for the process to exit
    $process.WaitForExit()
}
